this is part 3.
Modified in branch1.
